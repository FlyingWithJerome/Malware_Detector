'''
training.py

This trains the model to identify whether it is
a malware
'''

import numpy as np

from sklearn.tree import DecisionTreeClassifier
from sklearn.ensemble import RandomForestClassifier
from sklearn.linear_model import Perceptron
from sklearn.neural_network import MLPClassifier
from sklearn.ensemble import BaggingClassifier
from sklearn.neighbors import KNeighborsClassifier

from sklearn.cross_validation import KFold, cross_val_score


huge_data = np.loadtxt("API_22_training_final.txt")

X = huge_data[:, 150:-1]
y = huge_data[:, -1]

print(X.shape)
print(y.shape)


k_fold = KFold(len(y), n_folds=10, shuffle=True, random_state=0)
clf = RandomForestClassifier()
score_list = cross_val_score(clf, X, y, cv=k_fold, n_jobs=1)

print("Accuracy : %.2f"%(np.mean(score_list)))